From bed3c92e522ae7475f2f379e1546f06cee62b034 Mon Sep 17 00:00:00 2001
From: Tim Stahlhut <stahta01@gmail.com>
Date: Fri, 31 May 2019 00:44:59 -0400
Subject: Disable wxUSE_GRAPHICS_DIRECT2D

---
 include/wx/msw/chkconf.h | 7 +++++++
 include/wx/msw/gccpriv.h | 8 ++++++++
 2 files changed, 15 insertions(+)

diff --git a/include/wx/msw/chkconf.h b/include/wx/msw/chkconf.h
index abf12efc45..479b62b6a5 100644
--- a/include/wx/msw/chkconf.h
+++ b/include/wx/msw/chkconf.h
@@ -183,6 +183,13 @@
     #define wxUSE_SECRETSTORE 0
 #endif
 
+#if defined(__MINGW32__) && wxUSE_GRAPHICS_DIRECT2D
+    #if (!wxCHECK_MINGW64_VERSION(7, 0) && !wxCHECK_MINGW32_VERSION(7, 0))
+        #undef wxUSE_GRAPHICS_DIRECT2D
+        #define wxUSE_GRAPHICS_DIRECT2D 0
+    #endif
+#endif
+
 #if wxUSE_SPINCTRL
 #   if !wxUSE_SPINBTN
 #       ifdef wxABORT_ON_CONFIG_ERROR
diff --git a/include/wx/msw/gccpriv.h b/include/wx/msw/gccpriv.h
index d0b47e4183..44fb487f00 100644
--- a/include/wx/msw/gccpriv.h
+++ b/include/wx/msw/gccpriv.h
@@ -65,6 +65,14 @@
         #endif
     #endif
 
+    #ifdef __MINGW64_TOOLCHAIN__
+        #define wxCHECK_MINGW64_VERSION( major, minor ) \
+ ( ( ( __MINGW64_VERSION_MAJOR > (major) ) \
+      || ( __MINGW64_VERSION_MAJOR == (major) && __MINGW64_VERSION_MINOR >= (minor) ) ) )
+    #else
+        #define wxCHECK_MINGW64_VERSION( major, minor ) (0)
+    #endif
+
     #define wxCHECK_MINGW32_VERSION( major, minor ) \
  ( ( ( __MINGW32_MAJOR_VERSION > (major) ) \
       || ( __MINGW32_MAJOR_VERSION == (major) && __MINGW32_MINOR_VERSION >= (minor) ) ) )
-- 
